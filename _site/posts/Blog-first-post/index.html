<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko-KR" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Apache Arrow를 이용해서 데이터 빨리 읽기" />
<meta name="author" content="Sangwook Baek" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="Intro MovieLens 데이터를 활용한 추천 시스템 예제 코드를 재구현하던 중, 데이터를 읽어오는 속도가 너무 느려 답답함을 느꼈습니다. 기존 코드가 pandas 기반으로 작성되어 있었기 때문에, 데이터 로딩 속도 개선을 위해 해당 부분을 가장 먼저 수정해야겠다고 판단하였습니다. 이 과정에서 겪은 시행착오와 개선 결과를 공유드리고자 합니다." />
<meta property="og:description" content="Intro MovieLens 데이터를 활용한 추천 시스템 예제 코드를 재구현하던 중, 데이터를 읽어오는 속도가 너무 느려 답답함을 느꼈습니다. 기존 코드가 pandas 기반으로 작성되어 있었기 때문에, 데이터 로딩 속도 개선을 위해 해당 부분을 가장 먼저 수정해야겠다고 판단하였습니다. 이 과정에서 겪은 시행착오와 개선 결과를 공유드리고자 합니다." />
<link rel="canonical" href="http://localhost:4000/posts/Blog-first-post/" />
<meta property="og:url" content="http://localhost:4000/posts/Blog-first-post/" />
<meta property="og:site_name" content="oogie" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-04-03T13:59:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Apache Arrow를 이용해서 데이터 빨리 읽기" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sangwook Baek","url":"https://github.com/SangwookBaek/"},"dateModified":"2025-04-03T21:24:59+09:00","datePublished":"2025-04-03T13:59:00+09:00","description":"Intro MovieLens 데이터를 활용한 추천 시스템 예제 코드를 재구현하던 중, 데이터를 읽어오는 속도가 너무 느려 답답함을 느꼈습니다. 기존 코드가 pandas 기반으로 작성되어 있었기 때문에, 데이터 로딩 속도 개선을 위해 해당 부분을 가장 먼저 수정해야겠다고 판단하였습니다. 이 과정에서 겪은 시행착오와 개선 결과를 공유드리고자 합니다.","headline":"Apache Arrow를 이용해서 데이터 빨리 읽기","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Blog-first-post/"},"url":"http://localhost:4000/posts/Blog-first-post/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Apache Arrow를 이용해서 데이터 빨리 읽기 | oogie
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="oogie">
<meta name="application-name" content="oogie">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/ko.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4949605970350780"
     crossorigin="anonymous"></script>
</head>

  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/profile.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">oogie</a>
    <p class="site-subtitle fst-italic mb-0">AI + Engineering</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>홈</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>카테고리</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>태그</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>아카이브</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT ME</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/SangwookBaek"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['mindustrylab','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">홈</a>
            </span>

          
        
          
        
          
            
              <span>Apache Arrow를 이용해서 데이터 빨리 읽기</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      포스트
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="검색..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">취소</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Apache Arrow를 이용해서 데이터 빨리 읽기</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        게시
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743656340"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2025/04/03
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          업데이트
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743683099"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2025/04/03
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/SangwookBaek/">Sangwook Baek</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2245 단어"
>
  <em>12 분</em>읽는 시간</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Apache Arrow를 이용해서 데이터 빨리 읽기</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Table of Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Apache Arrow를 이용해서 데이터 빨리 읽기</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="intro"><span class="me-2">Intro</span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>MovieLens 데이터를 활용한 추천 시스템 예제 코드를 재구현하던 중, 데이터를 읽어오는 속도가 너무 느려 답답함을 느꼈습니다.
기존 코드가 <code class="language-plaintext highlighter-rouge">pandas</code> 기반으로 작성되어 있었기 때문에, 데이터 로딩 속도 개선을 위해 해당 부분을 가장 먼저 수정해야겠다고 판단하였습니다.
이 과정에서 겪은 시행착오와 개선 결과를 공유드리고자 합니다.</p>

<h2 id="dask-와-apache-arrow"><span class="me-2">Dask 와 Apache Arrow</span><a href="#dask-와-apache-arrow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>pandas의 대안으로 <strong>Dask</strong> 와 <strong>Apache Arrow</strong> 2가지를 고려했습니다.</p>

<p>Dask는 병렬 분산 데이터 처리를 지원하는 모듈로 알고 있고 대규모 데이터를 처리할 때 안정적이고 빠르게 수행할 수 있는 것이 장점입니다.</p>

<p>Apache Arrow는 column wise 메모리 접근을 한다는 것이 특징이고 데이터 직렬화/역직렬화 없이 빠른 IO를 수행하는 것이 장점입니다.</p>

<p>이는 어디까지나 이론으로 알고있던거고 실제 코드로 전환하면서 생긴 시행착오랑 장단점을 정리해보려고 합니다.</p>

<p>전체 코드는 해당 <a href="https://github.com/SangwookBaek/RecommenderSytems_Introduction/blob/main/utils/data_loader.py">링크</a>에서 확인할 수 있습니다.<br />
데이터 로딩 중 병목이 걸리는 부분은 Dataloader._load() 이고 이 부분을 Dask와 pyarrow 기반으로 수정했습니다. <br />
그리고 나머지 예시 코드들과의 호환성을 위해서 Dataloader.load()함수의 return값은 기존의 pandas dataframe이 되도록 설정했습니다. 이 부분에서 병목이 발생할 수 있지만 예시 코드 호환성과 가독성을 위해서 기존 포맷을 유지했습니다.</p>

<h2 id="dask로-전환"><span class="me-2">Dask로 전환</span><a href="#dask로-전환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Dask의 장점은 분산처리가 된다는 것이고 pandas와 거의 동일한 형식을 가지고 있다는 것입니다. 그래서 기존 코드를 그대로 재활용해서 Dask로 전환하는 것은 어렵지 않을 것이라 예상했습니다. 그런데 생각보다 코드 변환에서 오류가 문제가 많았고 Dask는 적절한 선택이 아니었습니다.  <br />
결론부터 말하자면 movie data, tag data는 pandas로, rating data만 Dask로 읽어오는 구조로 만들었습니다.</p>

<h3 id="데이터-크기와-작업-특성에-따른-선택"><span class="me-2">데이터 크기와 작업 특성에 따른 선택</span><a href="#데이터-크기와-작업-특성에-따른-선택" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>평점 데이터(ratings)는 일반적으로 매우 큰 데이터셋이라 Dask의 병렬 처리 능력이 유용합니다.<br />
영화 정보(movies)와 태그(tags)는 상대적으로 작은 데이터셋이므로 Pandas로 처리하는 것이 더 효율적입니다.</p>

<h3 id="dask의-제한사항"><span class="me-2">Dask의 제한사항</span><a href="#dask의-제한사항" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Dask는 모든 Pandas 연산을 완벽하게 지원하지 않습니다. 특히 복잡한 groupby 연산이나 rank 같은 연산은 Dask에서 정확하게 구현하기 어려울 수 있는 것 같습니다.
사용자별 최신 평가 항목을 찾는 작업 같은 경우, 각 사용자의 모든 데이터를 한 번에 볼 수 있어야 정확한 결과가 나오는데, Dask의 분산 특성 때문에 이런 작업에는 한계가 있다는걸 알았습니다</p>

<h2 id="pyarrow로-전환"><span class="me-2">pyarrow로 전환</span><a href="#pyarrow로-전환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>PyArrow는 다음과 같은 특징을 가지고 있습니다.</p>
<ul>
  <li>Columnar Format</li>
  <li>zero - copy IO</li>
  <li>직렬화/역직렬화 없이 바로 IO 가능</li>
</ul>

<h3 id="columnar-format"><span class="me-2">Columnar Format</span><a href="#columnar-format" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>시스템 메모리 구조를 학습하면 row-major / column-major 접근 방식의 차이를 이해할 수 있습니다.<br />
보통은 row-major 방식이 일반적이지만, Apache Arrow는 columnar format을 사용합니다.<br />
이를 왜 사용하는지, 그리고 실제로 얼마나 빠른지를 예시와 함께 설명드립니다.</p>

<p>100개의 row, 20개의 column으로 구성된 DataFrame에서 특정 열(예: rating)에 접근한다고 가정해보았습니다.</p>

<ul>
  <li>dataframe에서 특정 열에 접근합니다.(e.g.  rating , etc)
    <ul>
      <li>pandas에서는 row 단위로 저장이 되어있습니다. age가 rating이 3번째 column이라면 100개의 rating을 접근하려면 [0][2],[1][2],…,[99][2]를 접근해야합니다.</li>
      <li>row major에서 메모리 access를 찍어보면 
  start +0 x 20(num_columns) x size_of_column + 2 * size_of_row<br />
  start +1 x 20(num_columns) x size_of_column + 2 * size_of_row<br />
  start +2 x 20(num_columns) x size_of_column + 2 * size_of_row<br />
  … <br />
  start +99 x 20(num_columns) x size_of_column + 2 * size_of_row  <br />
  와 같이 접근하는데, 이것은 일단 cache affinity가 낮기 때문에 느립니다.</li>
    </ul>
  </li>
  <li>이를 ndarray나 torch.tensor로 바꾸고 연산을 수행합니다.
    <ul>
      <li>ndarray나 torch.tensor로 바꾸기 위해서는 <strong>copy</strong>가 발생할 수 밖에 없습니다. 이유는 아래와 같습니다.</li>
      <li>ndarray와 tensor는 뽑힌 값들을 row로 가지게 됩니다. 간단히 생각하면 column단위로 저장 및 접근했던게 array로 바뀌면 row 단위로 저장 및 접근할 수 있게 됩니다.</li>
      <li>하나의 메모리에서 이걸 할 수 없으니까 따로 <strong>copy</strong>가 발생하고 느려집니다.</li>
    </ul>
  </li>
</ul>

<p>정리하자면 row wise 접근에서 column 단위로 데이터를 뽑아 다시 row 단위의 배열로 변환시켜 처리하는 과정이 굉장히 느릴 수 밖에 없습니다.</p>

<hr />
<p>Apache Arrow -&gt; numpy or torch.tensor를 봐보면</p>
<ul>
  <li>dataframe에서 특정 열에 접근합니다.(e.g.  rating , etc)
    <ul>
      <li>pandas에서는 row 단위로 저장이 되어있습니다. age가 rating이 3번째 column이라면 100개의 rating을 접근하려면 [0][2],[1][2],…,[99][2]를 접근해야합니다.</li>
      <li>row major에서 메모리 access를 찍어보면 
  start + 2(column index) x size_of_row + 0 * size_of_column<br />
  start + 2(column index) x size_of_row + 1 * size_of_column<br />
  start + 2(column index) x size_of_row + 2 * size_of_column<br />
  … <br />
  start + 2(column index) x size_of_row + 99 * size_of_column <br />
  와 같이 접근하는데, 보면 size_of_column만큼만 증가합니다. 애초에 memory 상에서 continuous하게 존재할 것이고 cache affinity가 매우 높아 빠를 수 밖에 없습니다.</li>
    </ul>
  </li>
  <li>이를 ndarray나 torch.tensor로 바꾸고 연산을 수행합니다.
    <ul>
      <li>apache arrow를 통해 처리한 값을 column으로 접근하지만, 그 저장은 row로 되어있습니다. 그래서 별도의 copy없이 이 값을 바로 indexing/처리합니다.</li>
    </ul>
  </li>
</ul>

<p>정리하자면 columnar 접근을 하기 때문에 dataframe에서 열단위로 데이터를 뽑고 처리할 때 메모리 접근 자체 속도도 빠르고 별도의 copy가 생기지 않는게 장점입니다.</p>

<p>추가로 직렬화/역직렬화가 필요없다는 것은 저장할 때 python 고유 메모리 양식이 아니라 C++, Java 등에서 쓸 수 있는 공통 메모리 양식으로 저장하기 때문에 이를 변환하는 직렬화 및 역직렬화가 필요없다는 의미이다.
(python 라이브러리로만 활용하면 이 부분은 의미가 없는것으로 보임)</p>

<h2 id="속도-비교"><span class="me-2">속도 비교</span><a href="#속도-비교" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>pandas, dask, apache arrow기반으로 코드를 작성했고 속도를 비교해봤습니다.</p>

<ul>
  <li>pandas : 23.2337초</li>
  <li>dask : 24.2178초</li>
  <li>apache arrow :<strong>2.3696초</strong></li>
</ul>

<p>이론대로 apache arrow가 미친듯이 빠른 속도를 냈습니다.</p>

<p>dask가 pandas보다 느린 이유에 대해서 생각해봤는데, dask는 결국 대용량 데이터를 멀티 인스턴스로 <strong>안정적</strong>으로 처리하는데 장점이 있는거지 속도를 무조건적으로 빠르지는 않은게 당연한 것 같습니다.<br />
분산처리 준비를 하는 과정 (task graph 생성 등)에서 오버헤드가 걸리고 lazy evaluation방식을 쓰는데 무슨 처리를 하냐에 따라 병목이 발생하면 한방에 메모리에 올려서 처리하는 pandas보다 느릴 수 밖에 없습니다.</p>

<p><code class="language-plaintext highlighter-rouge">요약</code></p>
<ul>
  <li>dask : 대규모 데이터에 대한 병렬분산 처리를 제공 / 중규모에서는 오버헤드 때문에 오히려 느릴 수 있고 병렬처리 특성상 지원하지 못하는 연산도 있음</li>
  <li>apache arrow : columnar기반의 저장으로 cache affinity가 높고 직렬화/역직렬화가 필요없으며 zero copy라는 특징이 있음</li>
</ul>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>항목</th>
      <th>pandas</th>
      <th>dask</th>
      <th>apache arrow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>주요 역할</td>
      <td>단일 머신에서 데이터 분석</td>
      <td>병렬 분산 데이터 처리</td>
      <td>메모리 내 데이터 포맷 (표준화된 컬럼 기반 구조)</td>
    </tr>
    <tr>
      <td>속도</td>
      <td>작고 중간 크기 데이터에 빠름</td>
      <td>대용량 데이터에 적합 (병렬 처리)</td>
      <td>데이터 직렬화/역직렬화 없이 빠른 I/O 가능</td>
    </tr>
    <tr>
      <td>주요 사용</td>
      <td>분석, 시각화, 전처리</td>
      <td>대용량 데이터 전처리, ETL, ML pipeline</td>
      <td>데이터 교환, zero-copy I/O, cross-language 처리</td>
    </tr>
  </tbody>
</table></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/data-engineering/">Data_engineering</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/apache-arrow/"
            class="post-tag no-text-decoration"
          >apache_arrow</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          이 글은 저작권자의 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         라이센스를 따릅니다.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">공유하기</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Apache%20Arrow%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B9%A8%EB%A6%AC%20%EC%9D%BD%EA%B8%B0%20-%20oogie&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlog-first-post%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Apache%20Arrow%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B9%A8%EB%A6%AC%20%EC%9D%BD%EA%B8%B0%20-%20oogie&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlog-first-post%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FBlog-first-post%2F&text=Apache%20Arrow%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%B4%EC%84%9C%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%B9%A8%EB%A6%AC%20%EC%9D%BD%EA%B8%B0%20-%20oogie" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="링크 복사하기"
      data-title-succeed="링크가 복사되었습니다!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">최근 업데이트</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Blog-first-post/">Apache Arrow를 이용해서 데이터 빨리 읽기</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/apache-arrow/">apache_arrow</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Table of Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    











            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <div class="btn btn-outline-primary disabled" aria-label="이전 글">
      <p>-</p>
    </div>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="다음 글">
      <p>-</p>
    </div>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/SangwookBaek">oogie</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다."
      >일부 권리 보유</span>
    
  </p>

  <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/apache-arrow/">apache_arrow</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      업데이트
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

